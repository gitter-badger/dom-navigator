/*! dom-navigator - v1.0.1 - 2014-08-18
* https://github.com/rmariuzzo/dom-navigator
* Copyright (c) 2014 Rubens Mariuzzo; Licensed MIT */
!function(a){"function"==typeof define&&define.amd?define([],function(){return a(window.jQuery)}):a(window.jQuery)}(function(a){function b(a){a=a||{};for(var b=1;b<arguments.length;b++)if(arguments[b])for(var c in arguments[b])arguments[b].hasOwnProperty(c)&&(a[c]=arguments[b][c]);return a}function c(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function d(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," ")}function e(a){return a.jquery||Array.isArray(a)?a[0]:a}var f=function(a,c){this.$doc=window.document,this.$container=a,this.$options=b({},f.defaults,c),this.$selected=null,this.$keydownHandler=null,this.$keys={},this.$keys[this.$options.left]=this.left,this.$keys[this.$options.up]=this.up,this.$keys[this.$options.right]=this.right,this.$keys[this.$options.down]=this.down,this.enable()},g={left:"left",up:"up",right:"right",down:"down"},h={auto:"auto",horizontal:"horizontal",vertical:"vertical"};if(f.defaults={mode:h.auto,selected:"selected",left:37,up:38,right:39,down:40},f.prototype.enable=function(){var a=this;this.$keydownHandler=function(b){a.handleKeydown.call(a,b)},this.$doc.addEventListener("keydown",this.$keydownHandler)},f.prototype.disable=function(){this.$keydownHandler&&this.$doc.removeEventListener("keydown",this.$keydownHandler)},f.prototype.destroy=function(){this.disable(),this.$container.domNavigator&&delete this.$container.domNavigator},f.prototype.left=function(){var a=null;switch(this.$options.mode){case h.auto:if(!this.$selected){a=this.elements()[0];break}var b=this.$selected.offsetLeft-1,c=this.$selected.offsetTop;a=this.elementsBefore(b,1/0).reduce(function(a,d){var e=Math.abs(b-d.offsetLeft)+Math.abs(c-d.offsetTop);return e<a.distance?{distance:e,element:d}:a},{distance:1/0}),a=a.element;break;case h.horizontal:if(!this.$selected){a=this.elements()[0];break}a=this.$selected.previousElementSibling;break;case h.vertical:}this.select(a,g.left)},f.prototype.up=function(){var a=null;switch(this.$options.mode){case h.auto:if(!this.$selected){a=this.elements()[0];break}var b=this.$selected.offsetLeft,c=this.$selected.offsetTop-1;a=this.elementsBefore(1/0,c).reduce(function(a,d){var e=Math.abs(b-d.offsetLeft)+Math.abs(c-d.offsetTop);return e<a.distance?{distance:e,element:d}:a},{distance:1/0}),a=a.element;break;case h.horizontal:break;case h.vertical:if(!this.$selected){a=this.elements()[0];break}a=this.$selected.previousElementSibling}this.select(a,g.up)},f.prototype.right=function(){var a=null;switch(this.$options.mode){case h.auto:if(!this.$selected){a=this.elements()[0];break}var b=this.$selected.offsetLeft+this.$selected.offsetWidth,c=this.$selected.offsetTop;a=this.elementsAfter(b,0).reduce(function(a,d){var e=Math.abs(d.offsetLeft-b)+Math.abs(d.offsetTop-c);return e<a.distance?{distance:e,element:d}:a},{distance:1/0}),a=a.element;break;case h.horizontal:if(!this.$selected){a=this.elements()[0];break}a=this.$selected.nextElementSibling;break;case h.vertical:}this.select(a,g.right)},f.prototype.down=function(){var a=null;switch(this.$options.mode){case h.auto:if(!this.$selected){a=this.elements()[0];break}var b=this.$selected.offsetLeft,c=this.$selected.offsetTop+this.$selected.offsetHeight;a=this.elementsAfter(0,c).reduce(function(a,d){var e=Math.abs(d.offsetLeft-b)+Math.abs(d.offsetTop-c);return e<a.distance?{distance:e,element:d}:a},{distance:1/0}),a=a.element;break;case h.horizontal:break;case h.vertical:if(!this.$selected){a=this.elements()[0];break}a=this.$selected.nextElementSibling}this.select(a,g.down)},f.prototype.selected=function(){return this.$selected},f.prototype.select=function(a,b){a&&a!==this.$selected&&(a=e(a),this.$selected&&d(this.$selected,this.$options.selected),this.scrollTo(a,b),c(a,this.$options.selected),this.$selected=a)},f.prototype.scrollTo=function(a,b){if(!this.inContainerViewport(a))switch(b){case g.left:this.$container.scrollLeft=a.offsetLeft-this.$container.offsetLeft;break;case g.up:this.$container.scrollTop=a.offsetTop-this.$container.offsetTop;break;case g.right:this.$container.scrollLeft=a.offsetLeft-this.$container.offsetLeft-(this.$container.offsetWidth-a.offsetWidth);break;case g.down:this.$container.scrollTop=a.offsetTop-this.$container.offsetTop-(this.$container.offsetHeight-a.offsetHeight)}},f.prototype.inContainerViewport=function(a){return a=e(a),a.offsetLeft-this.$container.scrollLeft<this.$container.offsetLeft?!1:a.offsetTop-this.$container.scrollTop<this.$container.offsetTop?!1:a.offsetLeft+a.offsetWidth-this.$container.scrollLeft>this.$container.offsetLeft+this.$container.offsetWidth?!1:a.offsetTop+a.offsetHeight-this.$container.scrollTop>this.$container.offsetTop+this.$container.offsetHeight?!1:!0},f.prototype.elements=function(){for(var a=[],b=this.$container.children.length;b--;)8!==this.$container.children[b].nodeType&&a.unshift(this.$container.children[b]);return a},f.prototype.elementsAfter=function(a,b){return this.elements().filter(function(c){return c.offsetLeft>=a&&c.offsetTop>=b})},f.prototype.elementsBefore=function(a,b){return this.elements().filter(function(c){return c.offsetLeft<=a&&c.offsetTop<=b})},f.prototype.handleKeydown=function(a){this.$keys[a.which]&&(a.preventDefault(),this.$keys[a.which].call(this))},window.DomNavigator=f,a){var i=a.fn.domNavigator;a.fn.domNavigator=function(a){var b,c=Array.prototype.slice.call(arguments,1);return this.each(function(){this.domNavigator||(this.domNavigator=new f(this,"object"==typeof a&&a)),"string"==typeof a&&this.domNavigator[a]&&(b=this.domNavigator[a].apply(this.domNavigator,c))}),void 0===b&&(b=this),b},a.fn.domNavigator.Constructor=f,a.fn.domNavigator.noConflict=function(){return a.fn.domNavigator=i,this}}});